<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Page 207</TITLE>

<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<BODY bgcolor="#FFFFFF" vlink="blue" link="blue" >
<p style="position:absolute;top:0px;left:0px"><img src="images/azure-cognitive-services-openai0207.png" width="892px" height="1252px">
</img></p>
<p style="position:absolute;top:636px;left:97px"><img src="images/azure-cognitive-services-openai_pic0049.png" width="700px" height="318px">
</img></p>
<p style="position:absolute;top:44px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h675w_h24w_h;letter-spacing:0.29770px;">yet.&nbsp;The&nbsp;n_tokens&nbsp;column&nbsp;is&nbsp;simply&nbsp;a&nbsp;way&nbsp;of&nbsp;making&nbsp;sure&nbsp;none&nbsp;of&nbsp;the&nbsp;data&nbsp;we&nbsp;pass&nbsp;to</span></p>
<p style="position:absolute;top:75px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h701w_h24w_h;letter-spacing:0.35541px;">the&nbsp;model&nbsp;for&nbsp;tokenization&nbsp;and&nbsp;embedding&nbsp;exceeds&nbsp;the&nbsp;input&nbsp;token&nbsp;limit&nbsp;of&nbsp;8,192.&nbsp;When</span></p>
<p style="position:absolute;top:104px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h658w_h24w_h;letter-spacing:0.34731px;">we&nbsp;pass&nbsp;the&nbsp;documents&nbsp;to&nbsp;the&nbsp;embeddings&nbsp;model,&nbsp;it&nbsp;will&nbsp;break&nbsp;the&nbsp;documents&nbsp;into</span></p>
<p style="position:absolute;top:133px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h702w_h24w_h;letter-spacing:0.36046px;">tokens&nbsp;similar&nbsp;(though&nbsp;not&nbsp;necessarily&nbsp;identical)&nbsp;to&nbsp;the&nbsp;examples&nbsp;above&nbsp;and&nbsp;then&nbsp;convert</span></p>
<p style="position:absolute;top:161px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h695w_h24w_h;letter-spacing:0.31772px;">the&nbsp;tokens&nbsp;to&nbsp;a&nbsp;series&nbsp;of&nbsp;floating&nbsp;point&nbsp;numbers&nbsp;that&nbsp;will&nbsp;be&nbsp;accessible&nbsp;via&nbsp;vector&nbsp;search.</span></p>
<p style="position:absolute;top:190px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h678w_h24w_h;letter-spacing:0.31980px;">These&nbsp;embeddings&nbsp;can&nbsp;be&nbsp;stored&nbsp;locally&nbsp;or&nbsp;in&nbsp;an&nbsp;Azure&nbsp;Database.&nbsp;As&nbsp;a&nbsp;result,&nbsp;each&nbsp;bill</span></p>
<p style="position:absolute;top:219px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h669w_h24w_h;letter-spacing:0.35074px;">will&nbsp;have&nbsp;its&nbsp;own&nbsp;corresponding&nbsp;embedding&nbsp;vector&nbsp;in&nbsp;the&nbsp;new&nbsp;ada_v2&nbsp;column&nbsp;on&nbsp;the</span></p>
<p style="position:absolute;top:250px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h221w_h24w_h;letter-spacing:0.36061px;">right&nbsp;side&nbsp;of&nbsp;the&nbsp;DataFrame.</span></p>
<p style="position:absolute;top:303px;left:115px"><span style="virtical-align:top;font-size:12px;font-family:AAAAAC+SegoeUI;color:#161616;w_h45w_h19w_h;letter-spacing:1.19594px;">Python</span></p>
<p style="position:absolute;top:482px;left:115px"><span style="virtical-align:top;font-size:12px;font-family:AAAAAC+SegoeUI;color:#161616;w_h45w_h19w_h;letter-spacing:1.19594px;">Python</span></p>
<p style="position:absolute;top:591px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAB+SegoeUI-Semibold;color:#161616;font-weight:bold;w_h63w_h24w_h;letter-spacing:0.00000px;">Output:</span></p>
<p style="position:absolute;top:983px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAF+SegoeUI-Italic;color:#161616;font-style:italic;w_h632w_h24w_h;letter-spacing:0.30397px;">As&nbsp;we&nbsp;run&nbsp;the&nbsp;search&nbsp;code&nbsp;block&nbsp;below,&nbsp;we'll&nbsp;embed&nbsp;the&nbsp;search&nbsp;query&nbsp;&quot;Can&nbsp;I&nbsp;get</span></p>
<p style="position:absolute;top:1011px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAB+SegoeUI-Semibold;color:#161616;font-weight:bold;w_h674w_h24w_h;letter-spacing:0.39781px;">information&nbsp;on&nbsp;cable&nbsp;company&nbsp;tax&nbsp;revenue?&quot;&nbsp;with&nbsp;the&nbsp;same&nbsp;text-embedding-ada-002</span></p>
<p style="position:absolute;top:1041px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#161616;w_h673w_h24w_h;letter-spacing:0.34567px;">(Version&nbsp;2)&nbsp;model.&nbsp;Next&nbsp;we'll&nbsp;find&nbsp;the&nbsp;closest&nbsp;bill&nbsp;embedding&nbsp;to&nbsp;the&nbsp;newly&nbsp;embedded</span></p>
<p style="position:absolute;top:1069px;left:96px"><span style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#0065b3;w_h374w_h24w_h;letter-spacing:0.34583px;">text&nbsp;from&nbsp;our&nbsp;query&nbsp;ranked&nbsp;by&nbsp;<a href="azure-cognitive-services-openai-47.html"style="virtical-align:top;font-size:16px;font-family:AAAAAC+SegoeUI;color:#0065b3;w_h0w_h0w_h;letter-spacing:0.00000px;">cosine&nbsp;similarity.</a></span></p>
<p style="position:absolute;top:1122px;left:115px"><span style="virtical-align:top;font-size:12px;font-family:AAAAAC+SegoeUI;color:#161616;w_h45w_h19w_h;letter-spacing:1.19594px;">Python</span></p>
<p style="position:absolute;top:350px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h615w_h18w_h;letter-spacing:0.55419px;">df_bills['ada_v2']&nbsp;=&nbsp;df_bills[&quot;text&quot;].apply(lambda&nbsp;x&nbsp;:&nbsp;get_embedding(x,</span></p>
<p style="position:absolute;top:372px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h658w_h18w_h;letter-spacing:0.49755px;">engine&nbsp;=&nbsp;'text-embedding-ada-002'))&nbsp;#&nbsp;engine&nbsp;should&nbsp;be&nbsp;set&nbsp;to&nbsp;the&nbsp;deployment</span></p>
<p style="position:absolute;top:393px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h615w_h18w_h;letter-spacing:0.50561px;">name&nbsp;you&nbsp;chose&nbsp;when&nbsp;you&nbsp;deployed&nbsp;the&nbsp;text-embedding-ada-002&nbsp;(Version&nbsp;2)</span></p>
<p style="position:absolute;top:415px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h43w_h18w_h;letter-spacing:0.00000px;">model</span></p>
<p style="position:absolute;top:529px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h69w_h18w_h;letter-spacing:0.00000px;">df_bills</span></p>
<p style="position:absolute;top:901px;left:753px"><span style="virtical-align:top;font-size:20px;font-family:CAAAAA+docons;color:#505050;w_h23w_h25w_h;letter-spacing:0.00000px;"><a href="https://learn.microsoft.com/en-us/azure/cognitive-services/openai/media/tutorials/embed-text-documents.png#lightbox"style="virtical-align:top;font-size:20px;font-family:CAAAAA+docons;color:#505050;w_h0w_h0w_h;letter-spacing:0.00000px;">ï Š</a></span></p>
<p style="position:absolute;top:1169px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h442w_h18w_h;letter-spacing:0.46520px;">#&nbsp;search&nbsp;through&nbsp;the&nbsp;reviews&nbsp;for&nbsp;a&nbsp;specific&nbsp;product</span></p>
<p style="position:absolute;top:1191px;left:116px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h485w_h18w_h;letter-spacing:0.61428px;">def&nbsp;search_docs(df,&nbsp;user_query,&nbsp;top_n=3,&nbsp;to_print=True):</span></p>
</BODY>
</HTML>
