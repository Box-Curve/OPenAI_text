<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Page 214</TITLE>

<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<BODY bgcolor="#FFFFFF" vlink="blue" link="blue" >
<p style="position:absolute;top:0px;left:0px"><img src="images/azure-cognitive-services-openai0214.png" width="892px" height="1252px">
</img></p>
<p style="position:absolute;top:42px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:64px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h459w_h18w_h;letter-spacing:0.56613px;">Console.WriteLine($&quot;Speech&nbsp;synthesized&nbsp;to&nbsp;speaker&nbsp;for</span></p>
<p style="position:absolute;top:85px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h147w_h18w_h;letter-spacing:0.55195px;">text:&nbsp;[{text}]&quot;);</span></p>
<p style="position:absolute;top:106px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
<p style="position:absolute;top:128px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h346w_h18w_h;letter-spacing:0.61265px;">else&nbsp;if&nbsp;(speechSynthesisResult.Reason&nbsp;==</span></p>
<p style="position:absolute;top:149px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h191w_h18w_h;letter-spacing:0.00000px;">ResultReason.Canceled)</span></p>
<p style="position:absolute;top:170px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:192px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h216w_h18w_h;letter-spacing:0.61497px;">var&nbsp;cancellationDetails&nbsp;=</span></p>
<p style="position:absolute;top:213px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h598w_h18w_h;letter-spacing:0.00000px;">SpeechSynthesisCancellationDetails.FromResult(speechSynthesisResult);</span></p>
<p style="position:absolute;top:235px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h398w_h18w_h;letter-spacing:0.63294px;">Console.WriteLine($&quot;Speech&nbsp;synthesis&nbsp;canceled:</span></p>
<p style="position:absolute;top:256px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h268w_h18w_h;letter-spacing:0.74014px;">{cancellationDetails.Reason}&quot;);</span></p>
<p style="position:absolute;top:299px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h286w_h18w_h;letter-spacing:0.65341px;">if&nbsp;(cancellationDetails.Reason&nbsp;==</span></p>
<p style="position:absolute;top:320px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h216w_h18w_h;letter-spacing:0.00000px;">CancellationReason.Error)</span></p>
<p style="position:absolute;top:341px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:363px;left:332px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h294w_h18w_h;letter-spacing:0.65716px;">Console.WriteLine($&quot;Error&nbsp;details:</span></p>
<p style="position:absolute;top:384px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h320w_h18w_h;letter-spacing:0.75090px;">{cancellationDetails.ErrorDetails}&quot;);</span></p>
<p style="position:absolute;top:406px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
<p style="position:absolute;top:427px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
<p style="position:absolute;top:448px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
<p style="position:absolute;top:470px;left:194px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
<p style="position:absolute;top:512px;left:194px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h563w_h18w_h;letter-spacing:0.46698px;">//&nbsp;Continuously&nbsp;listens&nbsp;for&nbsp;speech&nbsp;input&nbsp;to&nbsp;recognize&nbsp;and&nbsp;send&nbsp;as</span></p>
<p style="position:absolute;top:534px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h173w_h18w_h;letter-spacing:0.49201px;">text&nbsp;to&nbsp;Azure&nbsp;OpenAI</span></p>
<p style="position:absolute;top:555px;left:194px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h294w_h18w_h;letter-spacing:0.58715px;">async&nbsp;static&nbsp;Task&nbsp;ChatWithOpenAI()</span></p>
<p style="position:absolute;top:577px;left:194px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:598px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h442w_h18w_h;letter-spacing:0.46520px;">//&nbsp;Should&nbsp;be&nbsp;the&nbsp;locale&nbsp;for&nbsp;the&nbsp;speaker's&nbsp;language.</span></p>
<p style="position:absolute;top:619px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h511w_h18w_h;letter-spacing:0.66522px;">var&nbsp;speechConfig&nbsp;=&nbsp;SpeechConfig.FromSubscription(speechKey,</span></p>
<p style="position:absolute;top:641px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h121w_h18w_h;letter-spacing:0.00000px;">speechRegion);</span></p>
<p style="position:absolute;top:662px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h424w_h18w_h;letter-spacing:0.59370px;">speechConfig.SpeechRecognitionLanguage&nbsp;=&nbsp;&quot;en-US&quot;;</span></p>
<p style="position:absolute;top:705px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h199w_h18w_h;letter-spacing:0.51859px;">using&nbsp;var&nbsp;audioConfig&nbsp;=</span></p>
<p style="position:absolute;top:726px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h355w_h18w_h;letter-spacing:0.00000px;">AudioConfig.FromDefaultMicrophoneInput();</span></p>
<p style="position:absolute;top:746px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#0101fd;w_h545w_h18w_h;letter-spacing:0.59465px;">using&nbsp;var&nbsp;speechRecognizer&nbsp;=&nbsp;new&nbsp;SpeechRecognizer(speechConfig,</span></p>
<p style="position:absolute;top:768px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h113w_h18w_h;letter-spacing:0.00000px;">audioConfig);</span></p>
<p style="position:absolute;top:789px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#07704a;w_h260w_h18w_h;letter-spacing:0.56634px;">var&nbsp;conversationEnded&nbsp;=&nbsp;false;</span></p>
<p style="position:absolute;top:832px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#0101fd;w_h216w_h18w_h;letter-spacing:0.88241px;">while(!conversationEnded)</span></p>
<p style="position:absolute;top:853px;left:228px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:875px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h511w_h18w_h;letter-spacing:0.52061px;">Console.WriteLine(&quot;Azure&nbsp;OpenAI&nbsp;is&nbsp;listening.&nbsp;Say&nbsp;'Stop'&nbsp;or</span></p>
<p style="position:absolute;top:896px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h346w_h18w_h;letter-spacing:0.47752px;">press&nbsp;Ctrl-Z&nbsp;to&nbsp;end&nbsp;the&nbsp;conversation.&quot;);</span></p>
<p style="position:absolute;top:939px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h485w_h18w_h;letter-spacing:0.41708px;">//&nbsp;Get&nbsp;audio&nbsp;from&nbsp;the&nbsp;microphone&nbsp;and&nbsp;then&nbsp;send&nbsp;it&nbsp;to&nbsp;the</span></p>
<p style="position:absolute;top:960px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#008000;w_h104w_h18w_h;letter-spacing:0.64946px;">TTS&nbsp;service.</span></p>
<p style="position:absolute;top:982px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h303w_h18w_h;letter-spacing:0.59189px;">var&nbsp;speechRecognitionResult&nbsp;=&nbsp;await</span></p>
<p style="position:absolute;top:1003px;left:159px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h329w_h18w_h;letter-spacing:0.00000px;">speechRecognizer.RecognizeOnceAsync();</span></p>
<p style="position:absolute;top:1046px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#0101fd;w_h338w_h18w_h;letter-spacing:0.75380px;">switch&nbsp;(speechRecognitionResult.Reason)</span></p>
<p style="position:absolute;top:1067px;left:263px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:1088px;left:298px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#0101fd;w_h303w_h18w_h;letter-spacing:0.74771px;">case&nbsp;ResultReason.RecognizedSpeech:</span></p>
<p style="position:absolute;top:1110px;left:332px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h381w_h18w_h;letter-spacing:0.53311px;">if&nbsp;(speechRecognitionResult.Text&nbsp;==&nbsp;&quot;Stop.&quot;)</span></p>
<p style="position:absolute;top:1131px;left:332px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">{</span></p>
<p style="position:absolute;top:1153px;left:367px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#a31515;w_h355w_h18w_h;letter-spacing:0.61637px;">Console.WriteLine(&quot;Conversation&nbsp;ended.&quot;);</span></p>
<p style="position:absolute;top:1174px;left:367px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#07704a;w_h216w_h18w_h;letter-spacing:0.61497px;">conversationEnded&nbsp;=&nbsp;true;</span></p>
<p style="position:absolute;top:1195px;left:332px"><span style="virtical-align:top;font-size:13px;font-family:AAAAAE+Consolas;color:#161616;w_h9w_h18w_h;letter-spacing:0.00000px;">}</span></p>
</BODY>
</HTML>
